<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waste Classification</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<div class="container">
    <h1><i class="fas fa-recycle"></i> Waste Classification</h1>
    <form action="{{ url_for('predict') }}" method="post" enctype="multipart/form-data" id="upload-form">
        <div class="upload-container" id="drop-zone">
            <div class="upload-icon">
                <i class="fas fa-cloud-upload-alt"></i>
            </div>
            <input type="file" name="file" id="file" accept=".png,.jpg,.jpeg" required>
            <label for="file"><i class="fas fa-image"></i> Choose an image</label>
            <p class="drag-text">or drag and drop your image here</p>
            <p id="file-name" style="margin-top: 1rem; color: #666;">No file selected</p>

            <!-- âœ… Image preview container -->
            <div id="preview-container" style="margin-top: 1rem; display: none;">
                <img id="image-preview" src="" alt="Image Preview"
                     style="max-width: 100%; height: auto; border: 1px solid #ccc; padding: 5px;">
            </div>
        </div>
        <button type="submit"><i class="fas fa-search"></i> Classify Waste</button>
    </form>
</div>


<script>
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file');
    const fileName = document.getElementById('file-name');
    const previewContainer = document.getElementById('preview-container');
    const imagePreview = document.getElementById('image-preview');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });

    ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.classList.add('drag-over');
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropZone.classList.remove('drag-over');
    });

    dropZone.addEventListener('drop', handleDrop, false);
    fileInput.addEventListener('change', handleFileSelect, false);

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    function handleDrop(e) {
        const files = e.dataTransfer.files;
        if (files.length) {
            fileInput.files = files;
            updateFileDisplay(files[0]);
        }
    }

    function handleFileSelect(e) {
        const files = e.target.files;
        if (files.length) {
            updateFileDisplay(files[0]);
        }
    }

    function updateFileDisplay(file) {
        fileName.textContent = file.name;
        fileName.classList.add('file-selected');

        const reader = new FileReader();
        reader.onload = function(e) {
            imagePreview.src = e.target.result;
            previewContainer.style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
</script>

</body>
</html> 